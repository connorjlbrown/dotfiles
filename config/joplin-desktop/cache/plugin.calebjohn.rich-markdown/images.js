exports.default=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e,t,r){"use strict";function n(e,t,r){return{name:"RichMarkdownOverlay-"+e,requiredSettings:r,token:function(r){const n=function(e,t){return e.lastIndex=t.pos,e.exec(t.string)}(t,r),i=r.baseToken();if((null==i?void 0:i.type)&&(i.type.includes("jn-inline-code")||i.type.includes("comment")||i.type.includes("katex")))r.pos+=i.size;else{if(n&&n.index===r.pos)return r.pos+=n[0].length||1,e;n?r.pos=n.index:r.skipToEnd()}return null}}}Object.defineProperty(t,"__esModule",{value:!0}),t.onSourceChanged=t.remove=t.add=t.table_regex=t.hr_regex=t.list_token_regex=t.header_regex=t.strike_token_regex=t.sup_token_regex=t.sub_token_regex=t.insert_token_regex=t.highlight_token_regex=t.strong_underline_regex=t.strong_star_regex=t.emph_underline_regex=t.emph_star_regex=t.sup_regex=t.sub_regex=t.insert_regex=t.highlight_regex=t.html_image_regex=t.image_regex=t.link_regex=t.checkbox_inner_regex=t.checkbox_regex=void 0,t.checkbox_regex=/^(\s*)([*+-] )(\[[Xx ]\])\s.*$/g,t.checkbox_inner_regex=/(?<=\[)[Xx ](?=\])/g,t.link_regex=/(?<![\\])\[[^\]]*\]\(([^\(]+)\)|<([^>\s]+\.[^>\s]+)>|(https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9]+\.[^\s]{2,}|www\.[a-zA-Z0-9]+\.[^\s]{2,}[^\)])/g,t.image_regex=/!\[[^\]]*\]\([^\(]+\)/g,t.html_image_regex=/<img([^>]+?)\/?>/g,t.highlight_regex=/(?<!\\)==(?=[^\s])[^=]*[^=\s\\]==/g,t.insert_regex=/(?<!\\)\+\+(?=[^\s])[^\+]*[^\+\s\\]\+\+/g,t.sub_regex=/(?<![\\~])~(?=[^\s])[^~]*[^~\s\\]~/g,t.sup_regex=/(?<![\\[])\^(?=[^\s])[^\^]*[^\^\s\\[]\^/g,t.emph_star_regex=/(?<![\\\*])\*(?!\*)/g,t.emph_underline_regex=/(?<![\\\_])\_(?!\_)/g,t.strong_star_regex=/(?<![\\\*])\*\*(?!\*)/g,t.strong_underline_regex=/(?<![\\\_])\_\_(?!\_)/g,t.highlight_token_regex=/(?<![\\=])==(?!=)/g,t.insert_token_regex=/(?<![\\\+])\+\+(?!\+)/g,t.sub_token_regex=/(?<![\\~])~(?!~)/g,t.sup_token_regex=/(?<![\\\^])\^(?!\^)/g,t.strike_token_regex=/(?<![\\~])~~(?!~~)/g,t.header_regex=/^\s*#+\s/g,t.list_token_regex=/^(\s*)([*+-] \[[Xx ]\]\s|[*+->]\s|(\d+)([.)]\s))(\s*)/g,t.hr_regex=/^([*\-_])(?:\s*\1){2,}\s*$/,t.table_regex=/^\|[^\n]+\|/g;const i=[n("rm-checkbox",t.checkbox_regex,[]),n("rm-checkbox-check",t.checkbox_inner_regex,["extraCSS"]),n("rm-link",t.link_regex,[]),n("rm-image",t.image_regex,[]),n("rm-image",t.html_image_regex,[]),n("rm-list-token",t.list_token_regex,[]),n("search-marker",t.highlight_regex,["markHighlight"]),n("rm-ins",t.insert_regex,["insertHighlight"]),n("rm-sub",t.sub_regex,["subHighlight"]),n("rm-sup",t.sup_regex,["supHighlight"]),n("rm-header-token",t.header_regex,["extraCSS"]),n("rm-em-token",t.emph_star_regex,["extraCSS"]),n("rm-em-token",t.emph_underline_regex,["extraCSS"]),n("rm-strong-token",t.strong_star_regex,["extraCSS"]),n("rm-strong-token",t.strong_underline_regex,["extraCSS"]),n("rm-highlight-token",t.highlight_token_regex,["extraCSS","markHighlight"]),n("rm-ins-token",t.insert_token_regex,["extraCSS","insertHighlight"]),n("rm-sub-token",t.sub_token_regex,["extraCSS","subHighlight"]),n("rm-sup-token",t.sup_token_regex,["extraCSS","supHighlight"]),n("rm-strike-token",t.strike_token_regex,["extraCSS"]),n("rm-hr line-cm-rm-hr",t.hr_regex,["extraCSS"])],o=[(s="cm-rm-code-block",(e,t,r)=>{var n,i,o;(null==r?void 0:r.outer)&&((null===(n=null==r?void 0:r.outer)||void 0===n?void 0:n.code)||(null===(o=null===(i=null==r?void 0:r.outer)||void 0===i?void 0:i.thisLine)||void 0===o?void 0:o.fencedCodeEnd))?e.addLineClass(t,"wrap",s):e.removeLineClass(t,"wrap",s)})];var s;function l(e,t){for(let r of t)if(!e[r])return!1;return!0}t.add=function(e){if(e.state.richMarkdown)for(let t of i)l(e.state.richMarkdown.settings,t.requiredSettings)&&e.addOverlay(t)},t.remove=function(e){for(let t of i)e.removeOverlay(t)},t.onSourceChanged=function(e,t,r){for(let t=e.firstLine();t<=e.lastLine();t++){const r=e.getStateAfter(t,!0);for(let n of o)n(e,t,r)}}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{a(n.next(e))}catch(e){o(e)}}function l(e){try{a(n.throw(e))}catch(e){o(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,l)}a((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.clearAllWidgets=t.refreshAllWidgets=t.afterSourceChanges=t.onSourceChanged=t.html_image_line_regex=t.image_inline_regex=t.image_line_regex=void 0;const i=r(2),o=r(0);function s(e){return function(r){return n(this,void 0,void 0,(function*(){if(!r.target)return;if(!e.state.richMarkdown)return;if(!e.state.richMarkdown.settings.imageHover)return;if(!e.state.richMarkdown.settings.imageHoverCtrl&&(!r.ctrlKey&&!r.altKey||e.state.richMarkdown.isMouseHovering))return;e.state.richMarkdown.isMouseHovering=!0;const s=r.target;if(!s.offsetParent)return;if(e.state.richMarkdown.settings.inlineImages&&s.parentNode.childNodes.length<=3)return;const l=yield function(e,r){return n(this,void 0,void 0,(function*(){let{line:n,ch:s}=r;const l=e.getLine(n),a=i.getMatchAt(l,t.image_inline_regex,s);let u=null;if(a)u=yield g(a[2],a[1],e.state.richMarkdown.path_from_id);else{const t=i.getMatchAt(l,o.html_image_regex,s);t&&(u=yield c(t[0],e.state.richMarkdown.path_from_id))}return u}))}(e,i.getClickCoord(e,r));if(l){if(l.style.zoom){let e=parseFloat(l.style.zoom);l.style.zoom.endsWith("%")&&(e/=100),e&&(l.width*=e,l.height*=e,l.style.zoom="100%")}l.style.visibility="hidden",s.offsetParent.appendChild(l),l.style.position="absolute",l.style.zIndex="1000",l.classList.add("rich-markdown-hover-image"),l.onload=function(){if(!e.state.richMarkdown)return;if(!e.state.richMarkdown.isMouseHovering)return void l.remove();let t=this;const n=s.offsetParent,{right:i,width:o}=n.getBoundingClientRect();let a=0;t.clientWidth<o&&(a=Math.min(r.clientX,i-t.clientWidth));const c=e.coordsChar({left:a,top:r.clientY},"page");t.style.visibility="visible",e.addWidget(c,l,!1)}}}))}}function l(e){const t=e.getWrapperElement().getElementsByClassName("rich-markdown-hover-image");for(let e=t.length-1;e>=0;e--)t[e].remove()}function a(e){return function(t){e.state.richMarkdown&&(e.state.richMarkdown.isMouseHovering=!1),l(e)}}function c(e,t){return n(this,void 0,void 0,(function*(){const r=(new DOMParser).parseFromString(e,"text/html").body.firstChild;r.style.height=r.style.height||"auto",r.style.maxWidth=r.style.maxWidth||"100%";const n=["script","noscript","iframe","frameset","frame","object","base","embed","link","meta"];for(let e=0;e<r.attributes.length;e++){const t=r.attributes[e].name;(n.includes(t)||t.startsWith("on"))&&(r.attributes[e].value="")}if(r.src.length>=34){const e=r.src.substring(r.src.length-34);e.startsWith(":/")&&(r.src=yield t(e.substring(2)))}return r}))}function g(e,t,r){return n(this,void 0,void 0,(function*(){e.startsWith(":/")&&34==e.length&&(e=yield r(e.substring(2))),e.startsWith("<")&&e.endsWith(">")&&(e=e.substring(1,e.length-1));const n=document.createElement("img");return n.src=e,n.alt=t,n.style.maxWidth="100%",n.style.height="auto",n}))}function u(e){const t=e.getScrollInfo();for(let r=e.firstLine();r<=e.lastLine();r++){const n=e.lineInfo(r),i=(new Date).getTime();let o="";if(n.widgets)for(const r of n.widgets)if("rich-markdown-resource"===r.className){o=r.node.src.split("?t=")[0];const n=r.node.width,s=r.node.height;r.node.onload=function(){this.clientWidth==n&&this.clientHeight==s||(e.refresh(),e.scrollTo(t.left,t.top))},r.node.src=`${o}?t=${i}`}}}t.image_line_regex=/^\s*!\[([^\]]*)\]\((<[^\)]+>|[^)\s]+)[^)]*\)\s*$/,t.image_inline_regex=/!\[([^\]]*)\]\((<[^\)]+>|[^)\s]+)[^)]*\)/g,t.html_image_line_regex=/^\s*<img([^>]+?)\/?>\s*$/,t.onSourceChanged=function(e,r,i){e.state.richMarkdown&&e.state.richMarkdown.settings.inlineImages&&(!function(e,r,i){var o,s,l;n(this,void 0,void 0,(function*(){if(!e.state.richMarkdown)return;const n=e.getScrollInfo(),a=e.state.richMarkdown.path_from_id;for(let u=r;u<=i;u++){const r=e.lineInfo(u);if(r.widgets)for(const e of r.widgets)"rich-markdown-resource"===e.className&&e.clear();if(!r)continue;const i=e.getStateAfter(u,!0);if((null==i?void 0:i.outer)&&((null===(o=null==i?void 0:i.outer)||void 0===o?void 0:o.code)||(null===(l=null===(s=null==i?void 0:i.outer)||void 0===s?void 0:s.thisLine)||void 0===l?void 0:l.fencedCodeEnd)))continue;const d=r.text.match(t.image_line_regex);let h=null;if(d)h=yield g(d[2],d[1],a);else{const e=r.text.match(t.html_image_line_regex);e&&(h=yield c(e[0],a))}if(h){h.onload=function(){e.refresh(),e.scrollTo(n.left,n.top)};e.addLineWidget(u,h,{className:"rich-markdown-resource"})}}}))}(e,r,i),u(e))},t.afterSourceChanges=function(e){e.state.richMarkdown&&e.state.richMarkdown.settings.imageHover&&function(e){if(!e.state.richMarkdown)return;const t=e.getWrapperElement().getElementsByClassName("cm-rm-image");for(let r of t)r.onmouseenter=s(e),r.onmouseleave=a(e),e.state.richMarkdown.settings.imageHoverCtrl||(r.onmousemove=s(e))}(e)},t.refreshAllWidgets=u,t.clearAllWidgets=function(e){l(e);for(let t=e.firstLine();t<=e.lastLine();t++){const r=e.lineInfo(t);if(r.widgets)for(const e of r.widgets)"rich-markdown-resource"===e.className&&e.clear()}e.refresh()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clickAt=t.getClickCoord=t.getMatchAt=t.isCheckbox=t.isLink=void 0;const n=r(0);function i(e,t,r){let n=null;if(t.lastIndex=0,!t.global)return console.error("getMatchAt requires a global regex; Consider adding a `g` after ${regex}"),null;do{if(n=t.exec(e),!n)break;const i=n.index,o=i+n[0].length;if(i<=r&&r<=o)return n}while(n);return null}t.isLink=function(e){return!!e.target&&e.target.classList.contains("cm-rm-link")},t.isCheckbox=function(e){return!!e.target&&e.target.classList.contains("cm-rm-checkbox")},t.getMatchAt=i,t.getClickCoord=function(e,t){return(r=e.coordsChar({left:t.clientX,top:t.clientY})).sticky&&"before"===r.sticky?{ch:r.ch-1,line:r.line}:r;var r},t.clickAt=function(e,t){if(!e.state.richMarkdown)return;const r=e.state.richMarkdown.settings;if(r.links){const r=function(e,t){let{line:r,ch:o}=t;const s=e.getLine(r),l=i(s,n.link_regex,o);if(!l)return;let a="";for(let e=1;e<=4;e++)a=a||l[e];a&&a.endsWith(")")?i(s,n.image_regex,o)&&(a=a.slice(0,a.length-1)):a&&(a.endsWith('"')||a.endsWith("'"))&&(a=a.slice(0,a.length-1));return a=a.split(" ")[0],a}(e,t);if(r)return{name:"followLink",url:r}}return r.checkbox&&function(e,t){const r=e.getCursor(),{line:o,ch:s}=t,l=e.getLine(o),a=i(l,n.checkbox_regex,s);if(!a||!a[3])return!1;let c=l.indexOf(a[3]),g=c+a[3].length;const u=" "===a[3][1]?"[x]":"[ ]";e.replaceRange(u,{ch:c,line:o},{ch:g,line:o},"+input"),e.setCursor(r,null,{scroll:!1})}(e,t),null}}]).default;