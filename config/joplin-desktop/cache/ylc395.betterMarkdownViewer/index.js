!function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=joplin},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function u(e){try{a(i.next(e))}catch(e){r(e)}}function l(e){try{a(i.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,l)}a((i=i.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(n(0)),u=n(2);r.default.plugins.register({onStart:function(){return i(this,void 0,void 0,(function*(){yield u.setupSetting(),yield u.setupCodeMirror(),yield u.setupMarkdownViewer()}))}})},function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t},u=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function u(e){try{a(i.next(e))}catch(e){r(e)}}function l(e){try{a(i.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,l)}a((i=i.apply(e,t||[])).next())}))},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.setupSetting=t.setupCodeMirror=t.setupMarkdownViewer=void 0;const a=l(n(0)),c=n(3),s=n(4),d=r(n(5)),f=new d.default;t.setupMarkdownViewer=function(){return u(this,void 0,void 0,(function*(){yield a.default.contentScripts.register(c.ContentScriptType.MarkdownItPlugin,s.MARKDOWN_SCRIPT_ID,"./driver/markdownViewer/index.js"),yield a.default.contentScripts.onMessage(s.MARKDOWN_SCRIPT_ID,e=>{switch(e.event){case"queryCursorLine":return f.queryCursorLineForMD();case"updateCursorLine":return f.handleUpdateCursorLineForMD(e.payload)}})}))},t.setupCodeMirror=function(){return u(this,void 0,void 0,(function*(){yield a.default.contentScripts.register(c.ContentScriptType.CodeMirrorPlugin,s.CODE_MIRROR_SCRIPT_ID,"./driver/codeMirror/index.js"),yield a.default.contentScripts.onMessage(s.CODE_MIRROR_SCRIPT_ID,e=>{switch(e.event){case"updateCursorLine":return f.handleUpdateCursorLineForCM(e.payload);case"queryCursorLine":return f.queryCursorLineForCM()}})}))},t.setupSetting=function(){return u(this,void 0,void 0,(function*(){yield a.default.settings.registerSection("Better MD Viewer",{label:"Better MD Viewer"}),yield a.default.settings.registerSettings({[d.HIGHLIGHT_LINE_STYLE]:{label:"Highlight Current Line Style",type:c.SettingItemType.String,public:!0,value:"& {background: #FDFFBC}",section:"Better MD Viewer",description:"CSS statements for highlight current line. Use `&` to represent the selector of highlight line. For example: `& {background: yellow}` will make highlight line yellow. Left empty to disable highlighting"},[d.ENABLE_SYNC_TO_CM]:{label:"Double click to Switch To Editor",type:c.SettingItemType.Bool,public:!0,value:!0,section:"Better MD Viewer"},[d.TO_OPEN_EDITOR]:{label:"Double click will toggle editor out when in View Mode",type:c.SettingItemType.Bool,public:!0,value:!0,section:"Better MD Viewer"}}),f.update(d.HIGHLIGHT_LINE_STYLE,yield a.default.settings.value(d.HIGHLIGHT_LINE_STYLE)),f.update(d.ENABLE_SYNC_TO_CM,yield a.default.settings.value(d.ENABLE_SYNC_TO_CM)),f.update(d.TO_OPEN_EDITOR,yield a.default.settings.value(d.TO_OPEN_EDITOR)),yield a.default.settings.onChange(({keys:e})=>u(this,void 0,void 0,(function*(){for(const t of e)f.update(t,yield a.default.settings.value(t))})))}))}},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.ContentScriptType=t.SettingStorage=t.AppType=t.SettingItemType=t.ToolbarButtonLocation=t.isContextMenuItemLocation=t.MenuItemLocation=t.ImportModuleOutputFormat=t.FileSystemItem=void 0,function(e){e.File="file",e.Directory="directory"}(t.FileSystemItem||(t.FileSystemItem={})),function(e){e.Markdown="md",e.Html="html"}(t.ImportModuleOutputFormat||(t.ImportModuleOutputFormat={})),function(e){e.File="file",e.Edit="edit",e.View="view",e.Note="note",e.Tools="tools",e.Help="help",e.Context="context",e.NoteListContextMenu="noteListContextMenu",e.EditorContextMenu="editorContextMenu",e.FolderContextMenu="folderContextMenu",e.TagContextMenu="tagContextMenu"}(i=t.MenuItemLocation||(t.MenuItemLocation={})),t.isContextMenuItemLocation=function(e){return[i.Context,i.NoteListContextMenu,i.EditorContextMenu,i.FolderContextMenu,i.TagContextMenu].includes(e)},function(e){e.NoteToolbar="noteToolbar",e.EditorToolbar="editorToolbar"}(t.ToolbarButtonLocation||(t.ToolbarButtonLocation={})),function(e){e[e.Int=1]="Int",e[e.String=2]="String",e[e.Bool=3]="Bool",e[e.Array=4]="Array",e[e.Object=5]="Object",e[e.Button=6]="Button"}(t.SettingItemType||(t.SettingItemType={})),function(e){e.Desktop="desktop",e.Mobile="mobile",e.Cli="cli"}(t.AppType||(t.AppType={})),function(e){e[e.Database=1]="Database",e[e.File=2]="File"}(t.SettingStorage||(t.SettingStorage={})),function(e){e.MarkdownItPlugin="markdownItPlugin",e.CodeMirrorPlugin="codeMirrorPlugin"}(t.ContentScriptType||(t.ContentScriptType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CODE_MIRROR_SCRIPT_ID=t.MARKDOWN_SCRIPT_ID=void 0,t.MARKDOWN_SCRIPT_ID="contentScriptMarkdownIt",t.CODE_MIRROR_SCRIPT_ID="contentScriptCodeMirror"},function(e,t,n){"use strict";var i,o,r,u=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function u(e){try{a(i.next(e))}catch(e){r(e)}}function l(e){try{a(i.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,l)}a((i=i.apply(e,t||[])).next())}))},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.TO_OPEN_EDITOR=t.ENABLE_SYNC_TO_CM=t.HIGHLIGHT_LINE_STYLE=void 0;const a=l(n(0));t.HIGHLIGHT_LINE_STYLE="highlightLineStyle",t.ENABLE_SYNC_TO_CM="enableSyncToCM",t.TO_OPEN_EDITOR="toOpenEditor";t.default=class{constructor(){this.currentLine=null,this[i]="",this[o]=!0,this[r]=!0}update(e,t){e in this&&(this[e]=t)}queryCursorLineForMD(){return{line:this.currentLine,lineStyle:this.highlightLineStyle}}queryCursorLineForCM(){return this.currentLine}handleUpdateCursorLineForMD(e){return u(this,void 0,void 0,(function*(){this[t.ENABLE_SYNC_TO_CM]&&(this.currentLine=e,this[t.TO_OPEN_EDITOR]&&(yield this.toggleEditorOut()))}))}toggleEditorOut(){return u(this,void 0,void 0,(function*(){let e=yield a.default.settings.globalValue("noteVisiblePanes");for(;2!==e.length;)yield a.default.commands.execute("toggleVisiblePanes"),e=yield a.default.settings.globalValue("noteVisiblePanes")}))}handleUpdateCursorLineForCM(e){this.currentLine=e}},i=t.HIGHLIGHT_LINE_STYLE,o=t.ENABLE_SYNC_TO_CM,r=t.TO_OPEN_EDITOR}]);